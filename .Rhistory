graph_tipoabate_matadouro
# Grafico abates por matadouro por raca
<<<<<<< HEAD
# abates_matadouro_raca <- tabyl(Abates1, Matadouro, Raca)
# tabela_count_raca <- left_join(abates_matadouro, abates_matadouro_raca)
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca)
# Criar palete para as nossas 38 racas, porque as paletes pre definidas nao suportam tantas classes
pal <- brewer.pal(12, "Set3")
pal <- colorRampPalette(pal)(38)
=======
abates_matadouro_raca <- tabyl(Abates1, Matadouro, Raca)
tabela_count_raca <- left_join(abates_matadouro, abates_matadouro_raca)
View(tabela_count_raca)
View(tabela_count_raca)
graph_abates_matadouro_raca <- plot_ly(data = Abates1, x = ~Matadouro, y = ~Raca)
graph_abates_matadouro_raca
graph_abates_matadouro_raca <- plot_ly(data = Abates1, x = ~Matadouro, y = ~Raca, type = 'scatter')
graph_abates_matadouro_raca
graph_abates_matadouro_raca <- plot_ly(data = Abates1, x = ~Matadouro, y = ~n,
color = ~Raca, colors = 'Set3',
type = 'scatter', mode = 'markers' )
graph_abates_matadouro_raca
graph_abates_matadouro_raca <- plot_ly(data = Abates1, x = ~Matadouro, y = ~n(),
color = ~Raca, colors = 'Set3',
type = 'scatter', mode = 'markers' )
graph_abates_matadouro_raca
count(Abates1, Tipo_abate)
group_by(Abates1, Matadouro) %>% count(Abates1, Raca)
group_by(Abates1, Matadouro) %>% count(Raca)
x <- group_by(Abates1, Matadouro) %>% count(Raca)
View(x)
graph_abates_matadouro_raca <- plot_ly(data = x, x = ~Matadouro, y = ~n,
color = ~Raca, colors = 'Set3',
type = 'scatter', mode = 'markers')
graph_abates_matadouro_raca
warnings()
library(RColorBrewer)
pal <- brewer.pal('Set3')
View(tabela_count_raca)
pal <- colorRampPalette('Set3')(38)
pal <- brewer.pal(12, "Set3")
pal <- colorRampPalette(pal)(38)
graph_abates_matadouro_raca <- plot_ly(data = x, x = ~Matadouro, y = ~n,
color = ~Raca, colors = pal,
type = 'scatter', mode = 'markers')
graph_abates_matadouro_raca
View(abates_matadouro_raca)
# tabela_count_raca <- left_join(abates_matadouro, abates_matadouro_raca)
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca)
rm(x)
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
graph_abates_matadouro_raca <- plot_ly(data = tab_raca_matadouro, x = ~Matadouro, y = ~n,
color = ~Raca, colors = pal,
type = 'scatter', mode = 'markers')
graph_abates_matadouro_raca
<<<<<<< HEAD
library(tidyverse)
library(data.table)
library(plotly)
library(janitor)
library(RColorBrewer)
Abates <- fread("./Abates.csv")
Abates
Abates1 <- select(Abates, Matadouro, MAC, Tipo_abate, Exploracao, Raca) %>%
mutate(Matadouro = (str_replace(Matadouro,c("<",">"),"")))
=======
graph_tipoabate_matadouro
View(abates_matadouro_raca)
View(Abates)
graph_abates_matadouro_raca <- plot_ly(data = tab_raca_matadouro, x = ~Matadouro, y = ~n,
color = ~Raca, colors = pal,
type = 'scatter', mode = 'markers')
graph_abates_matadouro_raca
View(tab_raca_matadouro)
tab_raca_matadouro <- tab_raca_matadouro %>% mutate(Raca = (str_replace(Raca,c("<",">"),"")))
View(Abates)
graph_tipoabate_matadouro
View(Abates1)
# First try ANOVA
model <- aov(Tipo_abate ~ Raca, data = Abates1)
# First try ANOVA
model <- aov(Raca ~ Tipo_abate, data = Abates1)
model <- aov(Raca ~ Tipo_abate, data = Abates1)
model <- aov(Tipo_abate ~ Raca, data = Abates1)
model <- aov(Raca ~ Tipo_abate, data = Abates1)
Abates1 <- select(Abates, Matadouro, MAC, Tipo_abate, Exploracao, Raca) %>%
mutate(Matadouro = (str_replace(Matadouro,c("<",">"),""))) %>%
mutate(Raca = (str_replace(Raca,c("<",">"),"")))
View(Abates1)
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
# Grafico da percentagem de tipo de abate
graph_tipoabate <- plot_ly(data = count(Abates1, Tipo_abate),
labels = ~Tipo_abate, values = ~n, type = "pie") %>%
layout(title = "Tipo de Abates")
<<<<<<< HEAD
graph_tipoabate
=======
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
# Grafico de barras do total de abates por matadouro
abates_matadouro <- summarize(
group_by(Abates1, Matadouro),
count=n()
)
graph_abates_matadouro <- abates_matadouro %>%
plot_ly(x = ~count, y = ~Matadouro, type = 'bar') %>%
layout(title = "Abates por Matadouro")
<<<<<<< HEAD
graph_abates_matadouro
=======
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
# Grafico tipo de abate por matadouro
tipoabate_matadouro <- tabyl(Abates1, Matadouro, Tipo_abate)
graph_tipoabate_matadouro <- tipoabate_matadouro %>%
plot_ly(x = ~E, y = ~Matadouro, type = 'bar', name = 'Emergencia') %>%
add_trace(x = ~N, name = 'Normal') %>%
add_trace(x = ~S, name = 'Sanitario') %>%
layout(title = "Tipo de Abate por Matadouro", barmode = 'group')
<<<<<<< HEAD
graph_tipoabate_matadouro
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca)
View(tab_raca_matadouro)
# Criar palete para as nossas 38 racas, porque as paletes pre definidas nao suportam tantas classes
pal <- brewer.pal(12, "Set3")
pal <- colorRampPalette(pal)(38)
graph_abates_matadouro_raca <- plot_ly(data = tab_raca_matadouro, x = ~Matadouro, y = ~n,
color = ~Raca, colors = pal,
type = 'scatter', mode = 'markers')
graph_abates_matadouro_raca
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca)
# Criar palete para as nossas 38 racas, porque as paletes pre definidas nao suportam tantas classes
pal <- brewer.pal(12, "Set3")
pal <- colorRampPalette(pal)(38)
graph_abates_matadouro_raca <- plot_ly(data = tab_raca_matadouro, x = ~Matadouro, y = ~n,
color = ~Raca, colors = pal,
type = 'scatter', mode = 'markers')
graph_abates_matadouro_raca
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca) %>%  mutate(Matadouro = (str_replace(Raca,c("<",">"),"")))
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca) %>%  mutate(Raca = (str_replace(Raca,c("<",">"),"")))
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca)
tab_raca_matadouro <- mutate(Raca = (str_replace(Raca,c("<",">"),"")))
# Criar palete para as nossas 38 racas, porque as paletes pre definidas nao suportam tantas classes
pal <- brewer.pal(12, "Set3")
tab_raca_matadouro <- mutate(Raca = (str_replace(Raca,c("<",">"),"")))
tab_raca_matadouro <- tab_raca_matadouro %>%mutate(Raca = (str_replace(Raca,c("<",">"),"")))
=======
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca)
# Criar palete para as nossas 38 racas, porque as paletes pre definidas nao suportam tantas classes
pal <- brewer.pal(12, "Set3")
pal <- colorRampPalette(pal)(38)
graph_abates_matadouro_raca <- plot_ly(data = tab_raca_matadouro, x = ~Matadouro, y = ~n,
color = ~Raca, colors = pal,
type = 'scatter', mode = 'markers')
graph_tipoabate
graph_abates_matadouro
graph_tipoabate_matadouro
graph_abates_matadouro_raca
library(tidyverse)
library(data.table)
library(lubridate)
library(freqtables)
library(plotly)
library(rstatix)
Abates <- fread("./Abates.csv")
# 3 tipos diferentes de abates: Normal, Sanitário, Emergência
# Abates$MMA_CLA_CAR_GR corresponde a camada gordura
# Abates$MMA_CLA_CAR_CF corresponde a classificacao da carcaça na escala SEUROP
# Abates$MMA_CLA_CAR_CT corrresponde a classificação de acordo com idade e genero
# Regulamento 1308/2013 para verificar
# Temos de fazer se nao me engano a parte de Peso ao abate tendo em conta a raça, idade e sexo
##Descrição das variáveis
#Peso: variável quantitativa contínua
#Sexo: variável qualitativa nominal (binomial)
#Raça: variável qualitativa nominal
#Idade: variável quantitativa contínua
# Assim, vou selecionar as colunas que me interessam e garantir que sao da classe certa
# Calculei idade ao abate usando funcao do lubridate %--% e arredondei a 1 casa decimal
# Peso convertido a numerico, necessario substituir as , por .
Abates_peso <- select(Abates, Data_abate, Data_nasc, Peso, Raca, Sexo) %>%
mutate(
idade_ao_abate= round ((Data_nasc %--% Data_abate) / years(1),1),
Peso = as.numeric(str_replace(Peso, ",", ".")),
) %>%
mutate(Raca = (str_replace(Raca,c("<",">"),"")))
##ESTATÍSTICA DESCRITIVA
# Acho que repeti as tabelas de frequencia, mas if anything temos 2 maneiras possiveis de as fazer
# Fiz à brute force e com library freqtables
#VARIÁVEIS QUALITATIVAS
# Raca
Abates_prop_raca <- Abates_peso %>%
group_by(Raca) %>%
summarise(n = n()) %>%
mutate(Proportion = n / sum(n))%>%
mutate(Percent = (n / sum(n) * 100) %>% round(3))
Freq_abates_raca <- Abates_peso %>%
freq_table(Raca)
View(Abates_prop_raca)
View(Freq_abates_raca)
View(Abates_prop_raca)
View(Freq_abates_raca)
View(Abates_prop_raca)
#VARIÁVEIS QUALITATIVAS
# Raca
Abates_prop_raca <- Abates_peso %>%
group_by(Raca) %>%
summarise(n = n()) %>%
mutate(Proporção= n / sum(n))%>%
mutate(Percent = (n / sum(n) * 100) %>% round(3))
View(Abates_prop_raca)
#VARIÁVEIS QUALITATIVAS
# Raca
Abates_prop_raca <- Abates_peso %>%
group_by(Raca) %>%
summarise(n = n()) %>%
mutate(Proporção= n / sum(n))%>%
mutate(Percentagem = (n / sum(n) * 100) %>% round(3))
View(Abates_prop_raca)
#VARIÁVEIS QUALITATIVAS
# Raca
Abates_prop_raca <- Abates_peso %>%
group_by(Raca) %>%
summarise(Frequência = n()) %>%
mutate(Proporção= n / sum(n))%>%
mutate(Percentagem = (n / sum(n) * 100) %>% round(3))
View(Abates_prop_raca)
#VARIÁVEIS QUALITATIVAS
# Raca
Abates_prop_raca <- Abates_peso %>%
group_by(Raca) %>%
summarise(Frequência = n()) %>%
mutate(Proporção= Frequência / sum(Frequência))%>%
mutate(Percentagem = (Frequência / sum(Frequência) * 100) %>% round(3))
View(Abates_prop_raca)
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
library(tidyverse)
library(data.table)
library(plotly)
library(janitor)
library(RColorBrewer)
Abates <- fread("./Abates.csv")
<<<<<<< HEAD
Abates
=======
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
Abates1 <- select(Abates, Matadouro, MAC, Tipo_abate, Exploracao, Raca) %>%
mutate(Matadouro = (str_replace(Matadouro,c("<",">"),""))) %>%
mutate(Raca = (str_replace(Raca,c("<",">"),"")))
# Grafico da percentagem de tipo de abate
graph_tipoabate <- plot_ly(data = count(Abates1, Tipo_abate),
labels = ~Tipo_abate, values = ~n, type = "pie") %>%
layout(title = "Tipo de Abates")
<<<<<<< HEAD
graph_tipoabate
=======
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
# Grafico de barras do total de abates por matadouro
abates_matadouro <- summarize(
group_by(Abates1, Matadouro),
count=n()
)
<<<<<<< HEAD
graph_abates_matadouro <- abates_matadouro %>%
plot_ly(x = ~count, y = ~Matadouro, type = 'bar') %>%
layout(title = "Abates por Matadouro")
graph_abates_matadouro
=======
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
# Grafico tipo de abate por matadouro
tipoabate_matadouro <- tabyl(Abates1, Matadouro, Tipo_abate)
graph_tipoabate_matadouro <- tipoabate_matadouro %>%
plot_ly(x = ~E, y = ~Matadouro, type = 'bar', name = 'Emergencia') %>%
add_trace(x = ~N, name = 'Normal') %>%
add_trace(x = ~S, name = 'Sanitario') %>%
layout(title = "Tipo de Abate por Matadouro", barmode = 'group')
<<<<<<< HEAD
graph_tipoabate_matadouro
=======
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca)
# Criar palete para as nossas 38 racas, porque as paletes pre definidas nao suportam tantas classes
pal <- brewer.pal(12, "Set3")
pal <- colorRampPalette(pal)(38)
graph_abates_matadouro_raca <- plot_ly(data = tab_raca_matadouro, x = ~Matadouro, y = ~n,
color = ~Raca, colors = pal,
type = 'scatter', mode = 'markers')
<<<<<<< HEAD
graph_abates_matadouro_raca
=======
View(tab_raca_matadouro)
View(Abates1)
tab_raca_tipoabate <- tabyl(Abates1, Raca, Tipo_abate)
tab_raca_tipoabate
View(tab_raca_tipoabate)
chisq_raca_tipoabate <- chisq.test(tab_raca_tipoabate)
chisq_raca_tipoabate
fisher_raca_tipoabate <- fisher.test(tab_raca_tipoabate)
>>>>>>> 83de1e7425b695ad7ec38461fdbe2d7645fa83eb
library(tidyverse)
library(data.table)
library(plotly)
library(janitor)
library(RColorBrewer)
View(Abates1)
tab_exp_tipoabate <- tabyl(Abates1, Exploracao, Tipo_abate)
View(tab_exp_tipoabate)
chisq_exp_tipoabate <- chisq.test(tab_exp_tipoabate)
chisq_exp_tipoabate
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate)
chisq_exp_tipoabate
chisq_exp_tipoabate <- chisq.test(tab_exp_tipoabate)
View(tab_exp_tipoabate)
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate, Exploracao, E, N, S)
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate)
chisq_exp_tipoabate <- chisq.test(tab_exp_tipoabate)
tab_exp_tipoabate <- tabyl(Abates1, Exploracao, Tipo_abate)
library(tidyverse)
library(data.table)
library(plotly)
library(janitor)
library(RColorBrewer)
tab_exp_tipoabate <- tabyl(Abates1, Exploracao, Tipo_abate)
chisq_exp_tipoabate <- chisq.test(tab_exp_tipoabate)
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate)
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate, Exploracao, E, N, S)
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate, "Exploracao", "E", "N", "S")
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate, Exploracao, E, N, S)
View(Abates1)
tab_exp_tipoabate2 <- select(Abates1, Exploracao, Tipo_abate)
View(tab_exp_tipoabate2)
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate2)
chisq_exp_tipoabate <- chisq.test(tab_exp_tipoabate2)
View(tab_exp_tipoabate2)
graph_abates_matadouro_raca
View(Abates)
library(tidyverse)
library(data.table)
library(plotly)
library(janitor)
library(RColorBrewer)
library(leaflet)
library(sf)
library(lubridate)
library(measurements)
Abates <- fread("./Abates.csv")
Abates
Abates1 <- select(Abates, Matadouro, MAC, Tipo_abate, Exploracao, Raca) %>%
mutate(Matadouro = (str_replace(Matadouro,c("<",">"),""))) %>%
mutate(Raca = (str_replace(Raca,c("<",">"),"")))
# Grafico da percentagem de tipo de abate
graph_tipoabate <- plot_ly(data = count(Abates1, Tipo_abate),
labels = ~Tipo_abate, values = ~n, type = "pie") %>%
layout(title = "Tipo de Abates")
graph_tipoabate
# Grafico de barras do total de abates por matadouro
abates_matadouro <- summarize(
group_by(Abates1, Matadouro),
count=n()
)
graph_abates_matadouro <- abates_matadouro %>%
plot_ly(x = ~count, y = ~Matadouro, type = 'bar') %>%
layout(title = "Abates por Matadouro")
graph_abates_matadouro
# Grafico tipo de abate por matadouro
tipoabate_matadouro <- tabyl(Abates1, Matadouro, Tipo_abate)
graph_tipoabate_matadouro <- tipoabate_matadouro %>%
plot_ly(x = ~E, y = ~Matadouro, type = 'bar', name = 'Emergencia') %>%
add_trace(x = ~N, name = 'Normal') %>%
add_trace(x = ~S, name = 'Sanitario') %>%
layout(title = "Tipo de Abate por Matadouro", barmode = 'group')
graph_tipoabate_matadouro
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca)
# Criar palete para as nossas 38 racas, porque as paletes pre definidas nao suportam tantas classes
pal <- brewer.pal(12, "Set3")
pal <- colorRampPalette(pal)(38)
graph_abates_matadouro_raca <- plot_ly(data = tab_raca_matadouro, x = ~Matadouro, y = ~n,
color = ~Raca, colors = pal,
type = 'scatter', mode = 'markers')
tab_raca_tipoabate <- tabyl(Abates1, Raca, Tipo_abate)
chisq_raca_tipoabate <- chisq.test(tab_raca_tipoabate)
chisq_raca_tipoabate
fisher_raca_tipoabate <- fisher.test(tab_raca_tipoabate)
tab_exp_tipoabate <- tabyl(Abates1, Exploracao, Tipo_abate)
tab_exp_tipoabate2 <- select(Abates1, Exploracao, Tipo_abate)
chisq_exp_tipoabate <- chisq.test(tab_exp_tipoabate)
chisq_exp_tipoabate
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate2)
# mapa matadouro exploracoes #
# ficheiros
mapa_continente <- st_read("Cont_AAD_CAOP2020")
mapa_continente$geometry <- st_transform(mapa_continente$geometry, "+init=epsg:4326")
Codme <- fread("./C?d_ME_DiCo.csv") %>% unique
Abates2 <- mutate(Abates2, ME = paste("PT", Abates2$ME, sep = ''))
SantaCarnes <- Abates2[Abates2$Matadouro == "SANTACARNES - COMRC? E INDST? DE CARNES DE SANTAR?M, SA"] %>%
unique
Raporal <- Abates2[Abates2$Matadouro == "RAPORAL - RA??ES DE PORTUGAL, SA"] %>% unique
Abates2 <- select(Abates1, Matadouro, Exploracao)
names(Abates2)[names(Abates2) == 'Exploracao'] <- 'ME'
Abates2 <- mutate(Abates2, ME = paste("PT", Abates2$ME, sep = ''))
SantaCarnes <- Abates2[Abates2$Matadouro == "SANTACARNES - COMRC? E INDST? DE CARNES DE SANTAR?M, SA"] %>%
unique
Raporal <- Abates2[Abates2$Matadouro == "RAPORAL - RA??ES DE PORTUGAL, SA"] %>% unique
RegMafra <- Abates2[Abates2$Matadouro == "MATADOURO REGIONAL MAFRA"] %>% unique
Codme1 <- select(Codme, ME, DiCoFre)
Codme1 <- select(Codme, ME, DiCoFre)
Codme <- fread("./C?d_ME_DiCo.csv") %>% unique
unique
Codme <- fread("./Cód_ME_DiCo.csv") %>% unique
Total_Caract_Expl <- fread("./FicheiroTotalCaracterizacaoExploracoes-2022-10-04.csv")
Abates2 <- select(Abates1, Matadouro, Exploracao)
names(Abates2)[names(Abates2) == 'Exploracao'] <- 'ME'
Abates2 <- mutate(Abates2, ME = paste("PT", Abates2$ME, sep = ''))
SantaCarnes <- Abates2[Abates2$Matadouro == "SANTACARNES - COMRC? E INDST? DE CARNES DE SANTAR?M, SA"] %>%
unique
Raporal <- Abates2[Abates2$Matadouro == "RAPORAL - RA??ES DE PORTUGAL, SA"] %>% unique
RegMafra <- Abates2[Abates2$Matadouro == "MATADOURO REGIONAL MAFRA"] %>% unique
Codme1 <- select(Codme, ME, DiCoFre)
Codme1 <- mutate(Codme1, ME = paste("PT", Codme1$ME, sep = '')) #Don't run twice!!
Total_Caract_Expl <- Total_Caract_Expl %>% arrange(desc(DAT_ALT)) %>% distinct(CEX_MAR_EXP, .keep_all = TRUE)
Total_Caract_Expl <- fread("./FicheiroTotalCaracterizacaoExploracoes-2022-10-04.csv")
Total_Caract_Expl <- Total_Caract_Expl %>% arrange(desc(DAT_ALT)) %>% distinct(CEX_MAR_EXP, .keep_all = TRUE)
Total_Caract_Expl <- unite(Total_Caract_Expl, "DiCoFre", CEX_COD_DIS, CEX_COD_CON, CEX_COD_FRE, sep = "")
Total_Caract_Expl <- select(Total_Caract_Expl, CEX_MAR_EXP, DiCoFre) %>% unique
names(Total_Caract_Expl)[names(Total_Caract_Expl) == 'CEX_MAR_EXP'] <- 'ME'
Dados_Exp <- full_join(Codme1, Total_Caract_Expl) %>% unique
SantaCarnes <- left_join(SantaCarnes, Dados_Exp) %>% filter(nchar(DiCoFre) == 6)
Raporal <- left_join(Raporal, Dados_Exp) %>% filter(nchar(DiCoFre) == 6)
RegMafra <- left_join(RegMafra, Dados_Exp) %>% filter(nchar(DiCoFre) == 6)
# mapa Santa Carnes
mapa_SantaCarnes <- sp::merge(mapa_continente,SantaCarnes, by.x="Dicofre", by.y="DiCoFre")
# Palete
SantaCarnes_leaflet <- leaflet(data = mapa_SantaCarnes) %>%
addProviderTiles(providers$CartoDB.DarkMatter) %>%
addPolygons(weight=.75, fillColor = "green", fillOpacity = .7, color = "black", dashArray = "",
highlightOptions = highlightOptions(
weight = 5,
color = "#666",
dashArray = "",
fillOpacity = 0.7,
bringToFront = TRUE))
View(SantaCarnes_leaflet)
View(SantaCarnes)
SantaCarnes <- left_join(SantaCarnes, Dados_Exp) %>% filter(nchar(DiCoFre) == 6)
Raporal <- left_join(Raporal, Dados_Exp) %>% filter(nchar(DiCoFre) == 6)
# mapa matadouro exploracoes #
# ficheiros
mapa_continente <- st_read("Cont_AAD_CAOP2020")
SantaCarnes <- Abates2[Abates2$Matadouro == "SANTACARNES - COMRC? E INDST? DE CARNES DE SANTAR?M, SA"] %>%
unique
Raporal <- Abates2[Abates2$Matadouro == "RAPORAL - RA??ES DE PORTUGAL, SA"] %>% unique
RegMafra <- Abates2[Abates2$Matadouro == "MATADOURO REGIONAL MAFRA"] %>% unique
View(Abates2)
SantaCarnes <- Abates2[Abates2$Matadouro == "	SANTACARNES - COMRC� E INDST� DE CARNES DE SANTAR�M, SA"] %>%
unique
Codme <- fread("./Cód_ME_DiCo.csv") %>% unique
Total_Caract_Expl <- fread("./FicheiroTotalCaracterizacaoExploracoes-2022-10-04.csv")
View(Total_Caract_Expl)
View(Abates2)
Abates2 <- select(Abates1, Matadouro, Exploracao)
View(Abates2)
Abates <- fread("./Abates.csv")
Abates
Abates1 <- select(Abates, Matadouro, MAC, Tipo_abate, Exploracao, Raca) %>%
mutate(Matadouro = (str_replace(Matadouro,c("<",">"),""))) %>%
mutate(Raca = (str_replace(Raca,c("<",">"),"")))
# Grafico da percentagem de tipo de abate
graph_tipoabate <- plot_ly(data = count(Abates1, Tipo_abate),
labels = ~Tipo_abate, values = ~n, type = "pie") %>%
layout(title = "Tipo de Abates")
# Grafico de barras do total de abates por matadouro
abates_matadouro <- summarize(
group_by(Abates1, Matadouro),
count=n()
)
graph_abates_matadouro <- abates_matadouro %>%
plot_ly(x = ~count, y = ~Matadouro, type = 'bar') %>%
layout(title = "Abates por Matadouro")
# Grafico tipo de abate por matadouro
tipoabate_matadouro <- tabyl(Abates1, Matadouro, Tipo_abate)
graph_tipoabate_matadouro <- tipoabate_matadouro %>%
plot_ly(x = ~E, y = ~Matadouro, type = 'bar', name = 'Emergencia') %>%
add_trace(x = ~N, name = 'Normal') %>%
add_trace(x = ~S, name = 'Sanitario') %>%
layout(title = "Tipo de Abate por Matadouro", barmode = 'group')
graph_tipoabate_matadouro
tab_raca_matadouro <- group_by(Abates1, Matadouro) %>% count(Raca)
# Criar palete para as nossas 38 racas, porque as paletes pre definidas nao suportam tantas classes
pal <- brewer.pal(12, "Set3")
pal <- colorRampPalette(pal)(38)
graph_abates_matadouro_raca <- plot_ly(data = tab_raca_matadouro, x = ~Matadouro, y = ~n,
color = ~Raca, colors = pal,
type = 'scatter', mode = 'markers')
graph_abates_matadouro_raca
tab_raca_tipoabate <- tabyl(Abates1, Raca, Tipo_abate)
chisq_raca_tipoabate <- chisq.test(tab_raca_tipoabate)
chisq_raca_tipoabate
fisher_raca_tipoabate <- fisher.test(tab_raca_tipoabate)
tab_exp_tipoabate <- tabyl(Abates1, Exploracao, Tipo_abate)
tab_exp_tipoabate2 <- select(Abates1, Exploracao, Tipo_abate)
chisq_exp_tipoabate <- chisq.test(tab_exp_tipoabate)
chisq_exp_tipoabate
fisher_exp_tipoabate <- fisher.test(tab_exp_tipoabate2)
# mapa matadouro exploracoes #
# ficheiros
mapa_continente <- st_read("Cont_AAD_CAOP2020")
mapa_continente$geometry <- st_transform(mapa_continente$geometry, "+init=epsg:4326")
Codme <- fread("./Cód_ME_DiCo.csv") %>% unique
Total_Caract_Expl <- fread("./FicheiroTotalCaracterizacaoExploracoes-2022-10-04.csv")
Abates2 <- select(Abates1, Matadouro, Exploracao)
names(Abates2)[names(Abates2) == 'Exploracao'] <- 'ME'
Abates2 <- mutate(Abates2, ME = paste("PT", Abates2$ME, sep = ''))
View(Abates2)
SantaCarnes <- Abates2[Abates2$Matadouro == "	SANTACARNES - COMRC� E INDST� DE CARNES DE SANTAR�M, SA"] %>%
unique
