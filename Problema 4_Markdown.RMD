---
title: "Problema 4_Markdown"
output: html_document
date: "2022-11-26"
---


```{r setup, include=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
library(tidyverse)
library(data.table)
library(lubridate)
library(freqtables)
library(plotly)
library(rstatix)
library(car)

```

```{r include=FALSE}

Abates <- fread("./Abates.csv")

Abates_peso <- select(Abates, Data_abate, Data_nasc, Peso, Raca, Sexo) %>% 
  mutate(
    idade_ao_abate= round ((Data_nasc %--% Data_abate) / years(1),1),
    Peso = as.numeric(str_replace(Peso, ",", ".")),
    ) %>% 
  mutate(Raca = (str_replace(Raca,c("<",">"),"")))

Abates_peso$idade_range <- cut(Abates_peso$idade_ao_abate, breaks= c(0,1,2,3,4,5,10,20,30),
                               labels=c("0-1","1-2","2-3","3-4","4-5","5-10","10-20","+20"))

Abates_peso$peso_range <- cut(Abates_peso$Peso, breaks= c(0,50,100,150,200,250,300,350,400,450,500,550,600,650,700,800),
                              labels=c("0-50","50-100","100-150","150-200","200-250","250-300","300-350","350-400", "400-450", "450-500", "500-550", "550-600", "600-650", "650-700", "+700"))


```

## **Descrição das Variáveis trabalhadas**

Para esta análise, considerámos as seguintes **variáveis pré-existentes**:    
- Data de abate    
- Data de nascimento   
- Peso ao abate   
- Raça   
- Sexo  

Com base na data de abate e data de nascimento, foi-nos possível criar uma **nova variável** correspondente à idade.    
Além disso, para facilitar a análise, criámos **intervalos de classe** adaptados às variáveis idade e peso.  

Deste modo, analisámos as seguintes variáveis:     
- **Peso**: variável quantitativa contínua  
- **Sexo**: variável qualitativa nominal (binomial)  
- **Raça**: variável qualitativa nominal  
- **Idade**: variável quantitativa contínua  




## **Estatística Descritiva**

#### **Variáveis Qualitativas**   

**1. Raça**     

Tabela de Contingência   

```{r include=F}
Abates_prop_raca <- Abates_peso %>% 
  group_by(Raca) %>% 
  summarise(Frequência = n()) %>% 
  mutate(Proporção= Frequência / sum(Frequência))%>% 
  mutate(Percentagem = (Frequência / sum(Frequência) * 100) %>% round(3))
```
```{r echo=F}
as.data.frame(Abates_prop_raca)
```

**2. Sexo**     

Tabela de Contingência  

```{r include=F}
Abates_prop_sexo <- Abates_peso %>% 
  group_by(Sexo) %>% 
  summarise(Frequência = n()) %>% 
  mutate(Proporção = Frequência / sum(Frequência))%>% 
  mutate(Percentagem = (Frequência / sum(Frequência) * 100) %>% round(3))
```
```{r echo=F}
as.data.frame(Abates_prop_sexo)
```



#### **Variáveis Quantitativas Contínuas**

**1. Idade**     

```{r include=F}
stats_idade <- Abates_peso %>% 
  get_summary_stats(idade_ao_abate)
Abates_prop_idade <- Abates_peso %>% 
  group_by(idade_range) %>% 
  summarise(Frequência = n()) %>% 
  mutate(Proporção = Frequência / sum(Frequência))%>% 
  mutate(Percentagem = (Frequência / sum(Frequência) * 100) %>% round(3))
```


Medidas de estatística descritiva

```{r echo=F}
as.data.frame(stats_idade)
```

Legenda:   
n: número de observações   
min: mínimo  
max: máximo   
median: mediana  
mean: média   
q1, q3: 1º e 3º quartis, respetivamente   
iqr: intervalo interquartis   
mad: desvio absoluto médio 
sd: desvio padrão
se: erro padrão da média   
ci: intervalo de confiança de 95% 


Tabela de Contingência

```{r echo=F}
as.data.frame(Abates_prop_idade)
```




**2. Peso**

```{r include=F}
stats_peso <- Abates_peso %>% 
  get_summary_stats(Peso)
Abates_prop_peso <- Abates_peso %>% 
  group_by(peso_range) %>% 
  summarise(Frequência = n()) %>% 
  mutate(Proporção = Frequência / sum(Frequência))%>% 
  mutate(Percentagem = (Frequência / sum(Frequência) * 100) %>% round(3))
```


Medidas de estatística descritiva   

```{r echo=F}
as.data.frame(stats_peso)
```

Legenda:   
n: número de observações   
min: mínimo  
max: máximo   
median: mediana  
mean: média   
q1, q3: 1º e 3º quartis, respetivamente   
iqr: intervalo interquartis   
mad: desvio absoluto médio 
sd: desvio padrão
se: erro padrão da média   
ci: intervalo de confiança de 95% 


Tabela de Contingência   

```{r echo=F}
as.data.frame(Abates_prop_peso)
```


## **Tabela de Contingência de Variáveis agrupadas**

```{r include=F}
tabela_PxR <- as.data.frame.matrix(table(Abates_peso$peso_range,Abates_peso$Raca))
tabela_PxS <- as.data.frame.matrix(table(Abates_peso$peso_range,Abates_peso$Sexo))
tabela_PxI <- as.data.frame.matrix(table(Abates_peso$peso_range,Abates_peso$idade_range))
```

**Peso-Raça**

```{r echo=F}
tabela_PxR
```

**Peso-Sexo**

```{r echo=F}
tabela_PxS
```

**Peso-Idade**

```{r echo=F}
tabela_PxI
```


##  **Representação gráfica da Análise Descritiva**  

